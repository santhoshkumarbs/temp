plugins {
    id 'java'
}

group = 'com.example'
version = '1.0.0'
sourceCompatibility = '11'

repositories {
    mavenCentral()
}

configurations {
    cxf
}

dependencies {
    // Add Apache CXF dependencies for wsdl2java
    cxf "org.apache.cxf:cxf-tools-wsdlto-core:3.4.3"
    cxf "org.apache.cxf:cxf-tools-wsdlto-databinding-jaxb:3.4.3"
    cxf "org.apache.cxf:cxf-tools-wsdlto-frontend-jaxws:3.4.3"
    // Jakarta XML Binding API for JDK 11+
    implementation "jakarta.xml.bind:jakarta.xml.bind-api:2.3.3"
    runtimeOnly "org.glassfish.jaxb:jaxb-runtime:2.3.3"
}

// Task to generate Java classes from WSDL
task generateJavaFromWsdl {
    doLast {
        ant.taskdef(name: 'wsdl2java', classname: 'org.apache.cxf.tools.wsdlto.WSDLToJava', classpath: configurations.cxf.asPath)
        ant.wsdl2java('-d', 'src/main/java', '-client', 'src/main/resources/wsdl/yourService.wsdl')
    }
}

// Make sure the generated sources are compiled
sourceSets {
    main {
        java {
            srcDir 'src/main/java'
        }
    }
}

// Ensure compilation depends on Java classes being generated from WSDL
compileJava.dependsOn generateJavaFromWsdl
